



window.screen.width<=428?document.write('<script src="scripts/mobile.js"><\/script>'):768<=window.screen.width&&document.write('<script src="scripts/pc.js"><\/script>');let article2_div3_li1_a=document.querySelector("article:nth-child(2) div:nth-child(3) li:nth-child(1) a"),article2_div3_li2_a=document.querySelector("article:nth-child(2) div:nth-child(3) li:nth-child(2) a"),article2_div3_div=document.querySelector("article:nth-child(2) div:nth-child(3) div"),a=article2_div3_div,blobfile,jsonfile;function getvideo(e){fetch(e).then(function(e){return e.blob()}).then(function(e){blobfile=e;e=URL.createObjectURL(e);let t=document.createElement("video"),n=document.createElement("source");t.controls=!0,t.width="300",n.src=e,n.type="video/mp4",a.appendChild(t),t.appendChild(n)}).catch(function(e){alert("出错了："+e.message)})}function getjson(e){fetch(e).then(function(e){return e.json()}).then(function(t){jsonfile=t;let n=document.createElement("p");for(let e=0;e<t.text.length;e++)e===t.text.length-1?n.innerHTML+=t.text[e]:n.innerHTML+=t.text[e]+"<br>";a.appendChild(n)}).catch(function(e){alert("出错了： "+e.message)})}article2_div3_li1_a.addEventListener("click",function(){(!a.firstElementChild||"VIDEO"!==a.firstElementChild.nodeName&&"VIDEO"!==a.lastElementChild.nodeName)&&getvideo("images/周杰伦-稻香.mp4")}),article2_div3_li2_a.addEventListener("click",function(){(!a.firstElementChild||"P"!==a.firstElementChild.nodeName&&"P"!==a.lastElementChild.nodeName)&&getjson("json/beautiful_essay.json")});let db;window.onload=function(){function e(){let e=db.transaction(["video_os"],"readwrite").objectStore("video_os"),t=e.add(file1),n=e.add(file2);t.onsuccess=function(){console.log("视频存储成功")},t.onerror=function(){console.log("视频存储失败")},n.onsuccess=function(){console.log("视频存储成功")},n.onerror=function(){console.log("视频存储失败")}}function t(){let e=db.transaction(["video_os"]).objectStore("video_os"),t=e.get(file1.name);t.onsuccess=function(e){e=e.target.result.blob,e=URL.createObjectURL(e);let t=document.createElement("video"),n=document.createElement("source");t.controls=!0,t.width="300",n.src=e,n.type="video/mp4",a.appendChild(t),t.appendChild(n),console.log("视频显示成功")},t.onerror=function(){getvideo(file1.name),console.log("视频显示成功")};let n=e.get(file2.name);n.onsuccess=function(e){var t=e.target.result.json;let n=document.createElement("p");for(let e=0;e<t.text.length;e++)e===t.text.length-1?n.innerHTML+=t.text[e]:n.innerHTML+=t.text[e]+"<br>";a.appendChild(n),console.log("视频显示成功")},n.onerror=function(){getvideo(file2.name),console.log("视频显示成功")}}void 0!==blobfile&&(blobfile,setTimeout(e,1e3),setTimeout(t,2e3)),void 0!==jsonfile&&(jsonfile,setTimeout(e,1e3),setTimeout(t,2e3));let n=window.indexedDB.open("videos_db",1);n.onerror=function(){alert("数据库打开失败")},n.onsuccess=function(){console.log("Database opened successfully"),db=n.result},n.onupgradeneeded=function(e){let t=e.target.result,n=t.createObjectStore("video_os",{keyPath:"name"});n.createIndex("source","source",{unique:!1}),console.log("Database setup complete")}};
